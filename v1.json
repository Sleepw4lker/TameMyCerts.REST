{
  "swagger": "2.0",
  "info": {
    "version": "v1",
    "title": "The \"bring ADCS to REST\" API"
  },
  "schemes": [
    "https"
  ],
  "paths": {
    "/v1/CertificateAuthority": {
      "get": {
        "tags": [
          "CertificateAuthority"
        ],
        "summary": "Retrieves a collection of all available certificate authorities.",
        "operationId": "CertificateAuthority_GetAllCas",
        "consumes": [],
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "name": "prettyPrintCertificate",
            "in": "query",
            "description": "Causes returned certificates to contain headers and line breaks.",
            "required": false,
            "type": "boolean"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "schema": {
              "$ref": "#/definitions/CertificateAuthorityCollection"
            }
          }
        }
      }
    },
    "/v1/CertificateAuthority/{caName}": {
      "get": {
        "tags": [
          "CertificateAuthority"
        ],
        "summary": "Retrieves details for a certificate authority.",
        "operationId": "CertificateAuthority_GetCaByName",
        "consumes": [],
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "name": "caName",
            "in": "path",
            "description": "The common name of the target certificate authority.",
            "required": true,
            "type": "string"
          },
          {
            "name": "prettyPrintCertificate",
            "in": "query",
            "description": "Causes returned certificates to contain headers and line breaks.",
            "required": false,
            "type": "boolean"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "schema": {
              "$ref": "#/definitions/CertificateAuthority"
            }
          }
        }
      },
      "post": {
        "tags": [
          "CertificateAuthority"
        ],
        "summary": "Submits a certificate signing request to a certificate authority.",
        "operationId": "CertificateAuthority_SubmitCertificateRequest",
        "consumes": [
          "application/json",
          "application/x-www-form-urlencoded"
        ],
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "name": "caName",
            "in": "path",
            "description": "The common name of the target certificate authority.",
            "required": true,
            "type": "string"
          },
          {
            "name": "certificateRequest",
            "in": "body",
            "description": "The data structure containing the certificate request and optional settings.",
            "required": true,
            "schema": {
              "$ref": "#/definitions/CertificateRequest"
            }
          },
          {
            "name": "certificateTemplate",
            "in": "query",
            "description": "The certificate template the certificate request shall be assigned to.",
            "required": false,
            "type": "string"
          },
          {
            "name": "includeCertificateChain",
            "in": "query",
            "description": "Causes the response to be a PKCS#7 container including the certificate chain.",
            "required": false,
            "type": "boolean"
          },
          {
            "name": "prettyPrintCertificate",
            "in": "query",
            "description": "Causes returned certificates to contain headers and line breaks.",
            "required": false,
            "type": "boolean"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "schema": {
              "$ref": "#/definitions/SubmissionResponse"
            }
          }
        }
      }
    },
    "/v1/CertificateAuthority/{caName}/{requestId}": {
      "get": {
        "tags": [
          "CertificateAuthority"
        ],
        "summary": "Retrieves an issued certificate from a certificate authority.",
        "operationId": "CertificateAuthority_GetCertificateByRequestId",
        "consumes": [],
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "name": "caName",
            "in": "path",
            "description": "The common name of the target certificate authority.",
            "required": true,
            "type": "string"
          },
          {
            "name": "requestId",
            "in": "path",
            "description": "The request ID of the certificate to retrieve.",
            "required": true,
            "type": "integer",
            "format": "int32"
          },
          {
            "name": "includeCertificateChain",
            "in": "query",
            "description": "Causes the response to be a PKCS#7 container including the certificate chain.",
            "required": false,
            "type": "boolean"
          },
          {
            "name": "prettyPrintCertificate",
            "in": "query",
            "description": "Causes returned certificates to contain headers and line breaks.",
            "required": false,
            "type": "boolean"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "schema": {
              "$ref": "#/definitions/SubmissionResponse"
            }
          }
        }
      }
    }
  },
  "definitions": {
    "CertificateAuthorityCollection": {
      "description": "A collection of CertificateAuthority Objects.",
      "type": "object",
      "properties": {
        "certificateAuthorities": {
          "description": "A collection of CertificateAuthority Objects.",
          "type": "array",
          "items": {
            "$ref": "#/definitions/CertificateAuthority"
          }
        }
      }
    },
    "CertificateAuthority": {
      "description": "A data structure holding information about a certificate authority.",
      "type": "object",
      "properties": {
        "name": {
          "description": "The common name of the certificate authority.",
          "type": "string"
        },
        "certificateTemplates": {
          "description": "A list of all certificate templates offered by the certificate authority.",
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "certificate": {
          "description": "The current certificate authority certificate of the certificate authority.",
          "type": "string"
        }
      }
    },
    "CertificateRequest": {
      "description": "A data structure containing a certificate request and a list of optional request attributes.",
      "required": [
        "request"
      ],
      "type": "object",
      "properties": {
        "request": {
          "description": "The X.509 certificate signing request as BASE64 encoded DER. Request types are detected automatically.",
          "type": "string"
        },
        "requestAttributes": {
          "description": "Optional request attributes as a collection of strings.",
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "SubmissionResponse": {
      "description": "A data structure containing the result of an operations against a certification authority.",
      "type": "object",
      "properties": {
        "requestId": {
          "format": "int32",
          "description": "The request ID of the issued certificate, or the pending request.",
          "type": "integer"
        },
        "disposition": {
          "description": "The disposition status of the submission or retrieval request.",
          "enum": [
            "incomplete",
            "failed",
            "denied",
            "issued",
            "issuedSeparately",
            "pending"
          ],
          "type": "string"
        },
        "status": {
          "$ref": "#/definitions/Status"
        },
        "certificate": {
          "description": "The issued X.509 V3 certificate, if issued by the certificate authority, as BASE64-encoded DER.",
          "type": "string"
        }
      }
    },
    "Status": {
      "type": "object",
      "properties": {
        "code": {
          "format": "int32",
          "description": "The disposition code returned by the certificate authority for the certificate request as defined in CertCli.h.",
          "type": "integer"
        },
        "description": {
          "description": "The message the certification authority returned alongside with the disposition.",
          "type": "string"
        }
      }
    }
  }
}